/* shortcodes.js v1.0.0 | https://github.com/stamat/shortcodes.js | MIT License */
function parseAttributes(t){const e=/^\s*([a-z_]{1}[a-z0-9\-_]*)\s*$/i,r=/^\s*([a-z_]{1}[a-z0-9\-_]*)=("[^"]+"|'[^']+')\s*$/i,n=/^["']|["']$/g,s={},o=t.match(/\s*(?:([a-z_]{1}[a-z0-9\-_]*)=?(?:"([^"]+)"|'([^']+)')*)\s*/gi);for(let t=0;t<o.length;t++){const i=o[t];if(""!==i)if(e.test(i)){const[,t]=i.match(e);s[t]=null,e.lastIndex=0}else if(r.test(i)){const[,t,e]=i.match(r);s[t]=e.replace(n,""),n.lastIndex=0,r.lastIndex=0}}return s}function shallowMerge(t,e){for(const r in e)t[r]=e[r]}function clone(t){let e=null;if(isArray(t)){e=[];for(const r in t)e[r]=clone(t[r])}else if(isObject(t)){e={};for(const r in t)e[r]=clone(t[r])}else e=t;return e}function isObject(t){return"object"==typeof t&&!Array.isArray(t)&&null!==t}function isArray(t){return Array.isArray(t)}function isFunction(t){return"function"==typeof t}function propertyIsFunction(t,e){return t.hasOwnProperty(e)&&isFunction(t[e])}function transformDashToCamelCase2(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}function isEmptyElement(t){return""===t.innerHTML.trim()}function remove(t){const e=query(t);for(const t of e)t.remove()}function query(t){return t instanceof Array?t:t instanceof Element?[t]:document.querySelectorAll(t)}function css(t,e,r=!1){if(t&&e)for(let n in e)r&&(n=transformDashToCamelCase2(n)),t.style[n]=e[n]}function decodeHTML(t){const e=document.createElement("textarea");e.innerHTML=t;const r=e.value;return e.remove(),r}function insertBeforeElement(t,e){t&&e&&t.parentNode.insertBefore(e,t)}function getShortcodeContent(t){const e=t.match(/\[([^\[\]]+)\]/i);return e?e[1]:null}function isSpecificClosingTag(t,e){return new RegExp(`^\\/\\s*${e}\\s*$`,"i").test(t)}function getShortcodeName(t){const e=t.match(/^\s*([a-z_]{1}[a-z0-9\-_]*)\s*/i);return e?e[1]:null}var Shortcodes=class{constructor(t){this.descriptor_index={},this.exec_fns={},this.shopify_img_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(_[0-9]+x[0-9]*)(\.[a-z]{3,4}.*)$/gi,this.shopify_img_replacer_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(\.[a-z]{3,4}.*)$/gi,this.options={template_class:"template",self_anchor_class:"self-anchor",placement_class_prefix:"shortcode-landing"},t&&shallowMerge(this.options,t)}shopifyImageLink(t,e){let r="$2";e||(e=100);let n=this.shopify_img_replacer_re;if(!n.test(t))return t;this.shopify_img_re.test(t)&&(r="$3",n=this.shopify_img_re);const s=`$1_${e}x${r}`;return t.replace(n,s)}createSelfAnchor(t,e,r,n){const s=document.createElement("div"),o=[];return e&&o.push(e),r&&o.push(`shortcode-${r}`),n&&o.push(`${r}-sc-${n}`),s.className=o.join(" "),insertBeforeElement(t,s),s}iterateNode(t,e,r){const n={},s=t.children;let o=null,i=0;for(let t=0;t<s.length;t++){const c=s[t];let a=null;if(!(c instanceof HTMLPreElement||c.querySelector("pre"))){a=getShortcodeContent(decodeHTML(c.textContent.trim())),a&&!e.hasOwnProperty(getShortcodeName(a))&&(a=null)}if(a){if(o&&isSpecificClosingTag(a,o.name)){o=null,c.remove();continue}o=new Shortcode(a,clone(e[getShortcodeName(a)]),i);const t=this.createSelfAnchor(c,r,o.name,i);n.hasOwnProperty(o.uid)||(n[o.uid]=o,i++),n[o.uid].content.push(t),c.remove()}else o.uid&&n[o.uid].content.push(c)}return n}};Shortcodes.prototype.sortDOM=function(t){const e=t.descriptor,r=t.content,n=/^\s*\{\s*([a-z0-9\-_\s]+)\s*\}\s*$/gi,s=[],o={},i={};let c=0,a=null,l=null,p=null,h=0,u=!1;function f(){_(),h+=1}o.rest=[];const d={};let m={};function _(){for(const t in m)o[t].push(null);m=function(){res={};for(const t in d)res[t]=!0;return res}()}if(e.hasOwnProperty("elements"))for(const t in e.elements)"rest"!==t&&(l=t,o.hasOwnProperty(t)||(o[t]=[]),null===a&&(a=t),i.hasOwnProperty(t)||(i[t]=!0,c++)),d[t]=!0,m[t]=!0;for(let t=0;t<r.length;t++){let a=r[t];if(a.classList.contains(this.options.self_anchor_class)){"self"===e.anchor&&(e.anchor=a);continue}if(!a.matches("img")&&isEmptyElement(a))continue;let l=!1;if(e.hasOwnProperty("item_template")){var y=a.textContent.trim(),g=n.exec(y);if(n.lastIndex=0,g&&g.length>1){(h||u)&&f(),s[h]=g[1],u=!0;continue}}if(c)for(const t in i){if(o[t].length===e.elements[t].count)continue;if("img"===t&&a.querySelectorAll("li").length)continue;const r=a.querySelector(t);if(a.matches(t)||r){r&&(a=r),e.hasOwnProperty("item_template")&&!m.hasOwnProperty(t)&&f(),o[t].push(a),e.hasOwnProperty("item_template")&&delete m[t],l=!0;break}}l||(e.hasOwnProperty("item_template")?(o.rest[h]||(delete m.rest,o.rest[h]=[]),o.rest[h].push(a)):o.rest.push(a))}e.hasOwnProperty("item_template")&&_();let x=null;for(const t in i){var b=o[t].length;(null===p||b>x)&&(p=t,x=b)}return{elements:o,item_tags:s,first_element_key:a,last_element_key:l,max_element_key:p}},Shortcodes.prototype.executeProperties=function(t,e,r,n,s){if("attr"===r.extract_fn)if("string"==typeof r.extract_attr)extract=t[r.extract_fn](r.extract_attr),t.is("img")&&"src"===r.extract_attr&&extract&&this.shopify_img_re.test(extract)&&(extract=extract.replace(this.shopify_img_re,"$1$3"));else{extract=[];for(var o=0;o<r.extract_attr.length;o++)if("html"!==r.extract_attr[o]){if(t.is("img")&&"src"===r.extract_attr[o]){var i=t.attr("src");if(i&&this.shopify_img_re.test(i)){extract.push(i.replace(this.shopify_img_re,"$1$3"));continue}}var c=r.extract_attr[o];extract.push(t[r.extract_fn](c))}else extract.push(t.html())}else"self"===r.extract_fn?extract=t:extract=t[r.extract_fn]();if(r.hasOwnProperty("parse")&&("function"==typeof r.parse?extract=r.parse(extract):window.hasOwnProperty(r.parse)&&(extract=window[r.parse](extract))),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")&&"background-image"===r.bind_property)extract="url("+extract+")";else if("function"==typeof r.bind_fn)return void r.bind_fn(extract,e,r,n,s);switch(r.anchor_element){case"item":case"template":$target=e.find(r.anchor),e.is(r.anchor)&&0===$target.length&&($target=e),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")?$target[r.bind_fn](r.bind_property,extract):$target[r.bind_fn](extract);break;default:$target=$(n.anchor).find(r.anchor),$(n.anchor).is(r.anchor)&&0===$target.length&&($target=$(n.anchor)),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")?$target[r.bind_fn](r.bind_property,extract):$target[r.bind_fn](extract)}},Shortcodes.prototype.construct=function(t){let e=null;t.descriptor.hasOwnProperty("template")&&(e=this.getTemplate(t.descriptor.template));const r=this.sortDOM(t);if(t.descriptor.hasOwnProperty("item_template"))for(let s=0;s<r.elements[r.max_element_key].length;s++){const o=this.getTemplate(t.descriptor.item_template);r.item_tags[s]&&o.classList.add(r.item_tags[s]);for(const e in t.descriptor.elements){var n=t.descriptor.elements[e];if(r.elements[e][s]){const i=r.elements[e][s];this.executeProperties($(i),$(o),n,t.descriptor,s)}}const i=t.descriptor.hasOwnProperty("template")?e.querySelectorAll(t.descriptor.item_anchor):document.querySelectorAll(descriptor.anchor);this.bindFunction(o,i,t.descriptor.bind_fn,t.descriptor.bind_property,t,s)}else if(t.descriptor.hasOwnProperty("elements"))for(const s in t.descriptor.elements){n=t.descriptor.elements[s];if(r.elements.hasOwnProperty(s))for(let o=0;o<r.elements[s].length;o++){const i=r.elements[s][o],c=t.descriptor.hasOwnProperty("template")?e:document.querySelectorAll(t.descriptor.anchor);this.executeProperties($(i),$(c),n,t.descriptor,o)}}else{const n=t.descriptor.hasOwnProperty("template")?e:document.querySelectorAll(t.descriptor.anchor);this.bindFunction(r.elements.rest,n,t.descriptor.bind_fn,t.descriptor.bind_property,t)}return t.descriptor.hasOwnProperty("template")?(this.bindFunction(e,t.descriptor.anchor,t.descriptor.bind_fn,t.descriptor.bind_property,t),e):document.querySelector(t.descriptor.anchor)},Shortcodes.prototype.getTemplate=function(t){t=[t],this.options.template_class&&t.push(`.${this.options.template_class}`);const e=document.querySelector(t.join("")).cloneNode(!0);return e.classList.remove(this.options.template_class),e.removeAttribute("hidden"),e.removeAttribute("aria-hidden"),e},Shortcodes.prototype.register=function(t,e){this.descriptor_index[t]=e;const r=this;this.exec_fns[t]=function(t){t.executeAttributes(),propertyIsFunction(t.descriptor,"pre")&&t.descriptor.pre(t);const e=r.construct(t);e&&(t.classes.length&&e.classList.add(t.classes.join(" ")),css(e,t.css),e.classList.add("shortcode-js")),propertyIsFunction(t.descriptor,"callback")&&t.descriptor.callback(e,t)}},Shortcodes.prototype.execute=function(t,e){t.style.visibility="hidden";const r=this.iterateNode(t,this.descriptor_index,this.options.self_anchor_class);for(const t in r){const e=r[t].name;this.exec_fns.hasOwnProperty(e)&&this.exec_fns[e](r[t])}t.style.visibility="visible",e&&e(r,this.exec_fns)},Shortcodes.prototype.clear=function(){remove(".shortcode-js"),remove(".self-anchor")},Shortcodes.prototype.reinitialize=function(t,e){this.clear(),this.execute(t,e)},Shortcodes.prototype.bindFunction=function(t,e,r,n,s,o){if("string"==typeof e?e=query(e):e instanceof HTMLElement&&(e=[e]),"string"==typeof t?t=query(t):t instanceof HTMLElement&&(t=[t]),isFunction(r))return void r(t,e,n,s,o);const i={css:function(t,e,r,n,s){"string"==typeof r&&(r=[r]);for(let n=0;n<r.length;n++){const s=transformDashToCamelCase(r[n]);e.style[s]=t.style[s]}},html:function(t,e,r,n,s){e.innerHTML=t.innerHTML},text:function(t,e,r,n,s){e.textContent=t.textContent},prepend:function(t,e,r,n,s){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},append:function(t,e,r,n,s){e.appendChild(t)}};if(e.length)for(let c=0;c<e.length;c++)for(let a=0;a<t.length;a++)i.hasOwnProperty(r)&&i[r](t[a],e[c],n,s,o)},Shortcodes.prototype.extract=function(t,e){"string"==typeof t&&(t=querySingle(t)),"string"==typeof e&&(e=[e]);const r={},n=[];for(let s=0;s<e.length;s++)"html"!==e[s]?"text"!==e[s]?"text"!==e[s]?(r[e[s]]=t.getAttribute(e[s]),n.push(t.getAttribute(e[s]))):(r.self=t,n.push(t)):(r.text=t.textContent,n.push(t.textContent)):(r.html=t.innerHTML,n.push(t.innerHTML));return 1===n.length?n[0]:r};var Shortcode=class{constructor(t,e,r,n){const s=getShortcodeName(t),o=parseAttributes(t);delete o[s],this.tag_content=t,this.uid=`${s}-sc-${r}`,this.name=s,this.attributes=o,this.descriptor=clone(e),this.content=[],this.counter=r,this.classes=[],this.css={},this.options={placement_class_prefix:"shortcode-landing"},n&&shallowMerge(this.options,n)}executeAttributes(){var t=this;const e={"header-class":function(t,e){let r=null;t.descriptor.hasOwnProperty("header_selector")&&t.descriptor.header_selector&&(r=document.querySelector(t.descriptor.header_selector)),r||(r=document.querySelector("header")),r||(r=document.querySelector("body")),r.classList.add(e)},"body-class":function(t,e){document.querySelector("body").classList.add(e)},placement:function(e,r){e.descriptor.anchor="content"!==r?"."+t.options.placement_class_prefix+"-"+r:"self"},"background-color":function(t,e){t.css.backgroundColor=e},"background-image":function(t,e){t.css.backgroundImage=`url(${e})`},color:function(t,e){t.css.color=e}};if(this.descriptor.hasOwnProperty("attribute_parsers"))for(var r in this.descriptor.attribute_parsers)propertyIsFunction(this.descriptor.attribute_parsers,r)&&(e[r]=this.descriptor.attribute_parsers[r]);for(const t in this.attributes){const r=this.attributes[t];e.hasOwnProperty(t)&&r?e[t](this,r):this.classes.push(t)}return this}};