/* shortcodes.js v1.0.2 | https://github.com/stamat/shortcodes.js | MIT License */
(()=>{function t(t,e){for(const n in e)t[n]=e[n]}function e(t){let s=null;if(r(t)){s=[];for(const n in t)s[n]=e(t[n])}else if(n(t)){s={};for(const n in t)s[n]=e(t[n])}else s=t;return s}function n(t){return"object"==typeof t&&!Array.isArray(t)&&null!==t}function r(t){return Array.isArray(t)}function s(t){return"string"==typeof t}function o(t){return"function"==typeof t}function c(t,e){return t.hasOwnProperty(e)&&o(t[e])}function l(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}function a(t,e){r(e)||(e=[e]);for(let n=0;n<e.length;n++)if(!t.hasOwnProperty(e[n]))return!1;return!0}function p(t,e=document){const n=f(t,e);for(const t of n)t.remove()}function f(t,e=document){if(t instanceof Array||t instanceof NodeList)return t;if(t instanceof Element)return[t];if(e instanceof Element||e instanceof Document)return e.querySelectorAll(t);if(s(e)&&(e=f(e)),!e instanceof Array&&!e instanceof NodeList)return[];const n=[];for(const r of e)n.push(...r.querySelectorAll(t));return n}function h(t){const e=document.createElement("textarea");e.innerHTML=t;const n=e.value;return e.remove(),n}function u(t){const e=t.match(/\[([^\[\]]+)\]/i);return e?e[1]:null}function d(t){const e=t.match(/^\s*([a-z_]{1}[a-z0-9\-_]*)\s*/i);return e?e[1]:null}var m=class{constructor(n,r,s,o){const i=d(n),c=function(t){const e=/^\s*([a-z_]{1}[a-z0-9\-_]*)\s*$/i,n=/^\s*([a-z_]{1}[a-z0-9\-_]*)=("[^"]+"|'[^']+')\s*$/i,r=/^["']|["']$/g,s={},o=t.match(/\s*(?:([a-z_]{1}[a-z0-9\-_]*)=?(?:"([^"]+)"|'([^']+)')*)\s*/gi);for(let t=0;t<o.length;t++){const i=o[t];if(""!==i)if(e.test(i)){const[,t]=i.match(e);s[t]=null,e.lastIndex=0}else if(n.test(i)){const[,t,e]=i.match(n);s[t]=e.replace(r,""),r.lastIndex=0,n.lastIndex=0}}return s}(n);delete c[i],this.tag_content=n,this.uid=`${i}-sc-${s}`,this.name=i,this.attributes=c,this.descriptor=e(r),this.content=[],this.counter=s,this.classes=[],this.css={},this.options={placement_class_prefix:"shortcode-landing"},o&&t(this.options,o)}executeAttributes(){var t=this;const e={"header-class":function(t,e){let n=null;t.descriptor.hasOwnProperty("header_selector")&&t.descriptor.header_selector&&(n=document.querySelector(t.descriptor.header_selector)),n||(n=document.querySelector("header")),n||(n=document.querySelector("body")),n.classList.add(e)},"body-class":function(t,e){document.querySelector("body").classList.add(e)},placement:function(e,n){e.descriptor.anchor="content"!==n?`.${t.options.placement_class_prefix}-${n}`:"self"},"background-color":function(t,e){t.css.backgroundColor=e},"background-image":function(t,e){t.css.backgroundImage=`url(${e})`},color:function(t,e){t.css.color=e}};if(this.descriptor.hasOwnProperty("attribute_parsers"))for(const t in this.descriptor.attribute_parsers)c(this.descriptor.attribute_parsers,t)&&(e[t]=this.descriptor.attribute_parsers[t]);for(const t in this.attributes){const n=this.attributes[t];e.hasOwnProperty(t)&&n?e[t](this,n):this.classes.push(t)}return this}},y=class{constructor(e){this.descriptor_index={},this.exec_fns={},this.shopify_img_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(_[0-9]+x[0-9]*)(\.[a-z]{3,4}.*)$/gi,this.shopify_img_replacer_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(\.[a-z]{3,4}.*)$/gi,this.options={template_class:"template",self_anchor_class:"self-anchor",placement_class_prefix:"shortcode-landing"},e&&t(this.options,e)}shopifyImageLink(t,e){let n="$2";e||(e=100);let r=this.shopify_img_replacer_re;if(!r.test(t))return t;this.shopify_img_re.test(t)&&(n="$3",r=this.shopify_img_re);const s=`$1_${e}x${n}`;return t.replace(r,s)}createSelfAnchor(t,e,n,r){const s=document.createElement("div"),o=[];var i,c;return e&&o.push(e),n&&o.push(`shortcode-${n}`),r&&o.push(`${n}-sc-${r}`),s.className=o.join(" "),c=s,(i=t)&&c&&i.parentNode.insertBefore(c,i),s}iterateNode(t,n,r){const s={},o=t.children;let i=null,c=0;for(let t=0;t<o.length;t++){const p=o[t];let f=null;if(!(p instanceof HTMLPreElement||p.querySelector("pre"))){f=u(h(p.textContent.trim())),f&&!n.hasOwnProperty(d(f))&&(f=null)}if(f){if(i&&(l=f,a=i.name,new RegExp(`^\\/\\s*${a}\\s*$`,"i").test(l))){i=null,p.remove();continue}i=new m(f,e(n[d(f)]),c);const t=this.createSelfAnchor(p,r,i.name,c);s.hasOwnProperty(i.uid)||(s[i.uid]=i,c++),s[i.uid].content.push(t),p.remove()}else i.uid&&s[i.uid].content.push(p)}var l,a;return s}};y.prototype.sortDOM=function(t){const e=t.descriptor,n=t.content,r=/^\s*\{\s*([a-z0-9\-_\s]+)\s*\}\s*$/gi,s=[],o={},i={};let c=0,l=null,a=null,p=null,f=0,h=!1;function u(){y(),f+=1}o.rest=[];const d={};let m={};function y(){for(const t in m)o[t].push(null);m=function(){res={};for(const t in d)res[t]=!0;return res}()}if(e.hasOwnProperty("elements"))for(const t in e.elements)"rest"!==t&&(a=t,o.hasOwnProperty(t)||(o[t]=[]),null===l&&(l=t),i.hasOwnProperty(t)||(i[t]=!0,c++)),d[t]=!0,m[t]=!0;for(let t=0;t<n.length;t++){let l=n[t];if(l.classList.contains(this.options.self_anchor_class)){"self"===e.anchor&&(e.anchor=l);continue}if(!l.matches("img")&&""===l.innerHTML.trim())continue;let a=!1;if(e.hasOwnProperty("item_template")){var _=l.textContent.trim(),g=r.exec(_);if(r.lastIndex=0,g&&g.length>1){(f||h)&&u(),s[f]=g[1],h=!0;continue}}if(c)for(const t in i){if(o[t].length===e.elements[t].count)continue;if("img"===t&&l.querySelectorAll("li").length)continue;const n=l.querySelector(t);if(l.matches(t)||n){n&&(l=n),e.hasOwnProperty("item_template")&&!m.hasOwnProperty(t)&&u(),o[t].push(l),e.hasOwnProperty("item_template")&&delete m[t],a=!0;break}}a||(e.hasOwnProperty("item_template")?(o.rest[f]||(delete m.rest,o.rest[f]=[]),o.rest[f].push(l)):o.rest.push(l))}e.hasOwnProperty("item_template")&&y();let x=null;for(const t in i){var w=o[t].length;(null===p||w>x)&&(p=t,x=w)}return{elements:o,item_tags:s,first_element_key:l,last_element_key:a,max_element_key:p}},y.prototype.constructElements=function(t,e,n,o,i){const l=o.descriptor,a=n.extract?this.extract(t,n.extract):null;var p,h;if(a&&(function(t,e){if(!t||!e||!t.length)return!1;t instanceof Element&&(t=[t]),s(t)&&(t=f(t));for(const n of t)if(!n.matches(e))return!1;return!0}(t,"img")&&a.hasOwnProperty("src")&&this.shopify_img_re.test(a.src)&&(a.src=a.src.replace(this.shopify_img_re,"$1$3")),c(n,"parse_extracted")?n.parse(a,t,e,n,o,i):(h="parse_extracted",(p=n).hasOwnProperty(h)&&s(p[h])&&c(window,n.parse_extracted)&&window[n.parse_extracted](a,t,e,n,o,i)),n.hasOwnProperty("bind_extracted"))){r(n.bind_extracted)||(n.bind_extracted=[n.bind_extracted]),n.hasOwnProperty("anchor_element")?finalDestination=f(n.anchor,e):finalDestination=f(n.anchor,l.anchor),!finalDestination.length&&e.matches(n.anchor)&&(finalDestination=e),finalDestination instanceof Element&&(finalDestination=[finalDestination]);for(let t=0;t<finalDestination.length;t++)this.bindElement(finalDestination[t],n.bind_extracted,a,n,o,i)}},y.prototype.construct=function(t){let e=null;t.descriptor.hasOwnProperty("template")&&(e=this.getTemplate(t.descriptor.template));const n=this.sortDOM(t);if(t.descriptor.hasOwnProperty("item_template"))for(let s=0;s<n.elements[n.max_element_key].length;s++){const o=this.getTemplate(t.descriptor.item_template);n.item_tags[s]&&o.classList.add(n.item_tags[s]);for(const e in t.descriptor.elements){var r=t.descriptor.elements[e];if(n.elements[e][s]){const i=n.elements[e][s];this.constructElements(i,o,r,t,s)}}const i=t.descriptor.hasOwnProperty("template")?e.querySelectorAll(t.descriptor.item_anchor):document.querySelectorAll(descriptor.anchor);this.bindShortcode(o,i,t.descriptor.bind_fn,t.descriptor.bind_property,t,s)}else if(t.descriptor.hasOwnProperty("elements"))for(const s in t.descriptor.elements){r=t.descriptor.elements[s];if(n.elements.hasOwnProperty(s))for(let o=0;o<n.elements[s].length;o++){const i=n.elements[s][o],c=t.descriptor.hasOwnProperty("template")?e:document.querySelectorAll(t.descriptor.anchor);this.constructElements(i,c,r,t,o)}}else{const r=t.descriptor.hasOwnProperty("template")?e:document.querySelectorAll(t.descriptor.anchor);this.bindShortcode(n.elements.rest,r,t.descriptor.bind_fn,t.descriptor.bind_property,t)}return t.descriptor.hasOwnProperty("template")?(this.bindShortcode(e,t.descriptor.anchor,t.descriptor.bind_fn,t.descriptor.bind_property,t),e):document.querySelector(t.descriptor.anchor)},y.prototype.getTemplate=function(t){t=[t],this.options.template_class&&t.push(`.${this.options.template_class}`);const e=document.querySelector(t.join("")).cloneNode(!0);return e.classList.remove(this.options.template_class),e.removeAttribute("hidden"),e.removeAttribute("aria-hidden"),e},y.prototype.register=function(t,e){this.descriptor_index[t]=e;const n=this;this.exec_fns[t]=function(t){t.executeAttributes(),c(t.descriptor,"pre")&&t.descriptor.pre(t);const e=n.construct(t);e&&(t.classes.length&&e.classList.add(t.classes.join(" ")),function(t,e,n=!1){if(t&&e)for(let r in e)n&&(r=l(r)),t.style[r]=e[r]}(e,t.css),e.classList.add("shortcode-js")),c(t.descriptor,"callback")&&t.descriptor.callback(e,t)}},y.prototype.execute=function(t,e){t.style.visibility="hidden";const n=this.iterateNode(t,this.descriptor_index,this.options.self_anchor_class);for(const t in n){const e=n[t].name;this.exec_fns.hasOwnProperty(e)&&this.exec_fns[e](n[t])}t.style.visibility="visible",e&&e(n,this.exec_fns)},y.prototype.clear=function(){p(".shortcode-js"),p(".self-anchor")},y.prototype.reinitialize=function(t,e){this.clear(),this.execute(t,e)},y.prototype.bindElement=function(t,e,i,c,p,f){s(t)&&(t=querySingle(t)),s(e)&&(e=[e]);const h={append:function(t,e,n){if(n.hasOwnProperty("self")){n.self instanceof HTMLElement&&(n.self=[n.self]);for(let e=0;e<n.self.length;e++)t.appendChild(n.self[e])}},prepend:function(t,e,n){if(n.hasOwnProperty("self")){n.self instanceof HTMLElement&&(n.self=[n.self]);for(let e=0;e<n.self.length;e++)t.firstChild?t.insertBefore(n.self[e],t.firstChild):t.appendChild(n.self[e])}},html:function(t,e,n){n.hasOwnProperty("html")&&(t.innerHTML=n.html)},text:function(t,e,n){n.hasOwnProperty("text")&&(t.textContent=n.text)},style:function(t,e,s){r(e)||(e=[e]);for(let r=0;r<e.length;r++){if(!n(e[r])||!a(e[r],"style_property"))continue;const o=l(e[r].style_property);if(!s.hasOwnProperty(e[r].extracted_property))continue;let i=s[e[r].extracted_property];"backgroundImage"===o&&(i=`url(${i})`),t.style[o]=i}}};for(let r=0;r<e.length;r++)h.hasOwnProperty(e[r])?h[e[r]](t,e[r],i):o(e[r])?e[r](t,i,c,p,f):n(e[r])?h.style(t,e[r],i):t.setAttribute(e[r],i[e[r]])},y.prototype.bindShortcode=function(t,e,n,r,s,i){if("string"==typeof e?e=f(e):e instanceof HTMLElement&&(e=[e]),"string"==typeof t?t=f(t):t instanceof HTMLElement&&(t=[t]),o(n))return void n(t,e,r,s,i);const c={style:function(t,e,n,r,s){"string"==typeof n&&(n=[n]);for(let r=0;r<n.length;r++){const s=l(n[r]);e.style[s]=t.style[s]}},html:function(t,e,n,r,s){e.innerHTML=t.innerHTML},text:function(t,e,n,r,s){e.textContent=t.textContent},prepend:function(t,e,n,r,s){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},append:function(t,e,n,r,s){e.appendChild(t)}};if(e.length)for(let o=0;o<e.length;o++)for(let l=0;l<t.length;l++)c.hasOwnProperty(n)&&c[n](t[l],e[o],r,s,i)},y.prototype.extract=function(t,e){"string"==typeof t&&(t=querySingle(t)),"string"==typeof e&&(e=[e]);const s={},c={};s.html=function(t,e){c.html=t.innerHTML},s.text=function(t,e){c.text=t.textContent},s.self=function(t,e){c.self=t},s.style=function(t,n){if(a(e[i],["name","properties"])&&"style"!==!n.name){r(n.properties)||(n.properties=[n.properties]),c.style={};for(let e=0;e<n.properties.length;e++){const r=l(n.properties[e]);c.style[n.properties[e]]=t.style[r]}}},s.function=function(t,e){a(e,["name","extract_fn"])&&o(e.extract_fn)&&(c[e.name]=e.extract_fn(t))};for(let r=0;r<e.length;r++)s.hasOwnProperty(e[r])?s[e[r]](t,e[r]):n(e[r])?(s.function(t,e[r]),s.style(t,e[r])):c[e[r]]=t.getAttribute(e[r]);return c},"undefined"!=typeof window&&(window.Shortcodes=y)})();