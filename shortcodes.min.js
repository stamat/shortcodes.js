/* shortcodes.js v1.0.0 | https://github.com/stamat/shortcodes.js | MIT License */
function _cloneObject(e){let t={};for(const r in e)t[r]=clone(e[r]);return t}function _cloneArray(e){let t=[];for(var r=0;r<e.length;r++)t[r]=clone(e[r]);return t}function clone(e){let t=null;return t="object"==typeof e&&null!==e?_cloneObject(e):Array.isArray(e)?_cloneArray(e):e,t}function Shortcodes(e){for(var t in this.descriptor_index={},this.exec_fns={},this.shopify_img_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(_[0-9]+x[0-9]*)(\.[a-z]{3,4}.*)$/gi,this.shopify_img_replacer_re=/^([a-z\.:\/]+\.shopify\.[a-z0-9\/_\-]+)(\.[a-z]{3,4}.*)$/gi,e||(e={}),this.defaults={templates:"#templates",template_class:"template",self_anchor_class:"self-anchor",placement_class_prefix:"shortcode-landing"},this.options=e,this.defaults)this.options.hasOwnProperty(t)||(this.options[t]=this.defaults[t])}Shortcodes.prototype.shopifyImageLink=function(e,t){var r="$2",s=this.shopify_img_replacer_re;if(!s.test(e))return e;this.shopify_img_re.test(e)&&(r="$3",s=this.shopify_img_re),t||(t=100);var n="$1_"+t+"x"+r;return e.replace(s,n)},Shortcodes.prototype.parseDOM=function(e,t){for(var r={},s=null,n=(e=$(e)).length>1?e:$(e).children(),a=/\[([\/a-z0-9\-_\s]+)\]/gi,o=0,i=0;i<n.length;i++){var c=$(n[i]),l=null;if(!c.is("pre")&&!c.find("pre").length){var h=c.text().toLowerCase().trim();l=a.exec(h);a.lastIndex=0}if(l&&l.length>1){if(0===l[1].indexOf("/")&&s&&s.indexOf(l[1].replace(/^\//,""))>-1){s=null,c.remove();continue}s=l[1]+" sc"+o;var p=$('<div class="'+this.options.self_anchor_class+" shortcode-"+s.split(/\s+/)[0]+" sc"+o+'" />');r.hasOwnProperty(s)||(r[s]=[],o++),c.before(p),r[s].push(p),c.remove()}else if(s&&(r[s].push(c),c.detach()),t&&s!==t&&r.hasOwnProperty(t))return r[t]}return t&&r.hasOwnProperty(t)?r[t]:r},Shortcodes.prototype.sortDOM=function(e,t){var r=/^\{([a-z0-9\-_\s]+)\}$/gi,s=[],n={},a={},o=0,i=null,c=null,l=null,h=0,p=!1;function f(){u(),h+=1}n.rest=[];var _={},d={};function u(){for(var e in d)n[e].push(null);d=function(){for(var e in res={},_)res[e]=!0;return res}()}if(e.hasOwnProperty("elements"))for(var m in e.elements)"rest"!==m&&(c=m,n.hasOwnProperty(m)||(n[m]=[]),null===i&&(i=m),a.hasOwnProperty(m)||(a[m]=!0,o++)),_[m]=!0,d[m]=!0;for(var y=0;y<t.length;y++){var g=$(t[y]);if(g.hasClass("self-anchor"))"self"===e.anchor&&(e.anchor=g);else if(g.is("img")||""!==g.html().trim()){var x=!1;if(e.hasOwnProperty("item_template")){var v=g.text().toLowerCase().trim(),b=r.exec(v);if(r.lastIndex=0,b&&b.length>1){(h||p)&&f(),s[h]=b[1],p=!0;continue}}if(o)for(var m in a)if(n[m].length!==e.elements[m].count&&("img"!==m||!g.find("li").length)){var w=g.find(m);if(g.is(m)||w.length){w.length&&(g=w.first()),e.hasOwnProperty("item_template")&&!d.hasOwnProperty(m)&&f(),n[m].push(g),e.hasOwnProperty("item_template")&&delete d[m],x=!0;break}}x||(e.hasOwnProperty("item_template")?(n.rest[h]||(delete d.rest,n.rest[h]=[]),n.rest[h].push(g[0])):n.rest.push(g[0]))}}e.hasOwnProperty("item_template")&&u();var O=null;for(var m in a){var P=n[m].length;(null===l||P>O)&&(l=m,O=P)}return{elements:n,item_tags:s,first_element_key:i,last_element_key:c,max_element_key:l}},Shortcodes.prototype.executeProperties=function(e,t,r,s,n){if("attr"===r.extract_fn)if("string"==typeof r.extract_attr)extract=e[r.extract_fn](r.extract_attr),e.is("img")&&"src"===r.extract_attr&&extract&&this.shopify_img_re.test(extract)&&(extract=extract.replace(this.shopify_img_re,"$1$3"));else{extract=[];for(var a=0;a<r.extract_attr.length;a++)if("html"!==r.extract_attr[a]){if(e.is("img")&&"src"===r.extract_attr[a]){var o=e.attr("src");if(o&&this.shopify_img_re.test(o)){extract.push(o.replace(this.shopify_img_re,"$1$3"));continue}}var i=r.extract_attr[a];extract.push(e[r.extract_fn](i))}else extract.push(e.html())}else"self"===r.extract_fn?extract=e:extract=e[r.extract_fn]();if(r.hasOwnProperty("parse")&&("function"==typeof r.parse?extract=r.parse(extract):window.hasOwnProperty(r.parse)&&(extract=window[r.parse](extract))),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")&&"background-image"===r.bind_property)extract="url("+extract+")";else if("function"==typeof r.bind_fn)return void r.bind_fn(extract,t,r,s,n);switch(r.anchor_element){case"item":case"template":$target=t.find(r.anchor),t.is(r.anchor)&&0===$target.length&&($target=t),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")?$target[r.bind_fn](r.bind_property,extract):$target[r.bind_fn](extract);break;default:$target=$(s.anchor).find(r.anchor),$(s.anchor).is(r.anchor)&&0===$target.length&&($target=$(s.anchor)),"css"===r.bind_fn&&r.hasOwnProperty("bind_property")?$target[r.bind_fn](r.bind_property,extract):$target[r.bind_fn](extract)}},Shortcodes.prototype.bind=function(e,t,r){var s=null;e.hasOwnProperty("template")&&(s=this.getTemplate(e.template));var n=this.sortDOM(e,t);if(e.hasOwnProperty("item_template"))for(var a=0;a<n.elements[n.max_element_key].length;a++){var o=this.getTemplate(e.item_template);for(var i in n.item_tags[a]&&o.addClass(n.item_tags[a]),e.elements){var c=e.elements[i];if(n.elements[i][a]){var l=$(n.elements[i][a]);this.executeProperties(l,o,c,e,a)}}var h=e.hasOwnProperty("template")?s.find(e.item_anchor):$(e.anchor);"function"==typeof e.bind_fn?e.bind_fn(o,h,e,r,a):h[e.bind_fn](o)}else if(e.hasOwnProperty("elements"))for(var i in e.elements){c=e.elements[i];if(n.elements.hasOwnProperty(i))for(a=0;a<n.elements[i].length;a++){l=$(n.elements[i][a]),h=e.hasOwnProperty("template")?s:$(e.anchor);this.executeProperties(l,h,c,e,a)}}else{h=e.hasOwnProperty("template")?s:$(e.anchor);"function"==typeof e.bind_fn?e.bind_fn(n.elements.rest,h,e,r):h[e.bind_fn](n.elements.rest)}return e.hasOwnProperty("template")?("function"==typeof e.bind_fn?e.bind_fn(s,$(e.anchor),e,r):$(e.anchor)[e.bind_fn](s),s):$(e.anchor)},Shortcodes.prototype.getTemplate=function(e){var t=$(this.options.templates).find(e+"."+this.options.template_class).clone();return t.removeClass(this.options.template_class),t},Shortcodes.prototype.parseAttributes=function(e,t){var r=this,s={classes:[],css:{}},n={};if(e.hasOwnProperty("attribute_parsers"))for(var a in e.attribute_parsers)n[a]=e.attribute_parsers[a];n.header=function(e,t,r){var s=null;t.hasOwnProperty("header_selector")&&t.header_selector&&(s=$(t.header_selector)),null!==s&&s.length||(s=$("header")),null!==s&&s.length||(s=$("body")),s.addClass(e.join("-"))},n.placement=function(e,t,s){e[0]&&("content"===e[0]?t.anchor="self":t.anchor="."+r.options.placement_class_prefix+"-"+e[0])},n.background=function(e,t,r){e[0]&&"color"===e[0]&&e[1]?s.css["background-color"]="#"+e[1]:s.classes.push(r)},n.color=function(e,t,r){e[0]?s.css.color=e[0]:s.classes.push(r)};for(var o=0;o<t.length;o++){var i=t[o].trim().toLowerCase();if(!/sc[0-9]+/gi.test(i)){var c=i.split("-");c[0]&&n.hasOwnProperty(c[0])?n[c.shift()](c,e,i):s.classes.push(i)}}return s},Shortcodes.prototype.register=function(e,t){this.descriptor_index[e]=t;var r=this;this.exec_fns[e]=function(e,t,s){var n=clone(r.descriptor_index[e]),a=r.parseAttributes(n,t);n.hasOwnProperty("pre")&&n.pre&&n.pre(n,t,s,a);var o=r.bind(n,s,a);o.addClass(a.classes.join(" ")),o.css(a.css),o.addClass("shortcode-js"),n.hasOwnProperty("callback")&&n.callback&&n.callback(o,a,n)}},Shortcodes.prototype.execute=function(e,t){$(e).css("visibility","hidden");var r=this.parseDOM(e);for(var s in r){var n=s.split(/\s+/gi),a=n.shift();this.exec_fns.hasOwnProperty(a)&&this.exec_fns[a](a,n,r[s])}$(e).css("visibility","visible"),void 0!==t&&t(r,this.exec_fns)},Shortcodes.prototype.clear=function(){$(".shortcode-js").remove(),$(".self-anchor").remove()},Shortcodes.prototype.reinit=function(e,t){this.clear(),this.execute(e,t)};